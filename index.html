<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>File Upload</title>
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.11.2/css/all.css"
    />
    <!-- Bootstrap core CSS -->
    <link href="content/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Material Design Bootstrap -->
    <link href="content/css/mdb.min.css" rel="stylesheet" />
    <!-- Your custom styles (optional) -->
    <link href="content/css/style.css" rel="stylesheet" />
  </head>
  <body>
    <div class="container container-success">
      <div class="well">
        <form action="upload.php" enctype="multipart/form-data" method="post">
          <div class="row">
            <div class="col-md-6">
              <label for="first_name">First Name</label>
              <input
                type="text"
                name="first_name"
                id="first_name"
                class="form-control"
                required
              />
              <strong class="text-danger d-none" id="first_nameErr"></strong>
            </div>
            <div class="col-md-6">
              <label for="last_name">Last Name</label>
              <input
                type="text"
                name="last_name"
                id="last_name"
                class="form-control"
                required
              />
              <strong class="text-danger d-none" id="last_nameErr"></strong>
            </div>
          </div>

          <div class="row">
            <div class="col-md-12">
              <label for="email">Email</label>
              <input
                type="text"
                id="email"
                name="email"
                class="form-control"
                required
              />
              <strong class="text-danger d-none" id="emailErr"></strong>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <label for="phone_no">Phone</label>
              <input
                type="text"
                name="phone_no"
                id="phone_no"
                class="form-control"
                required
              />
              <strong class="text-danger d-none" id="phone_noErr"></strong>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <label for="address">Address</label>
              <input
                type="text"
                name="address"
                id="address"
                class="form-control"
                required
              />
              <strong class="text-danger d-none" id="addresssErr"></strong>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <label for="city">City</label>
              <input
                type="text"
                name="city"
                id="city"
                class="form-control"
                required
              />
              <strong class="text-danger d-none" id="cityErr"></strong>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <label for="state">State</label>
              <input
                type="text"
                name="state"
                id="state"
                class="form-control"
                required
              />
              <strong class="text-danger d-none" id="stateErr"></strong>
            </div>
            <div class="col-md-6">
              <label for="country">Country</label>
              <input
                type="text"
                name="country"
                id="country"
                class="form-control"
                required
              />
              <strong class="text-danger d-none" id="countryErr"></strong>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <label for="passport">Passport</label>
              <input
                type="file"
                name="passport"
                id="passport"
                class="form-control"
                required
              />
              <strong class="text-danger d-none" id="passportErr"></strong>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <label for="resume">Upload your resume <span></span>*</label>

              <input
                type="file"
                name="resume"
                id="resume"
                class="form-control"
                required
              />
              <strong class="text-danger d-none" id="resumeErr"></strong>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <label for="cover_letter">Upload a cover letter</label>
              <input
                type="file"
                name="cover_letter"
                id="cover_letter"
                class="form-control"
                required
              />
              <strong class="text-danger d-none" id="cover_letterErr"></strong>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <br />
              <button type="submit" class="btn btn-success col-md-6">
                Sumbit
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
    <!-- SCRIPTS -->
    <!-- JQuery -->
    <script
      type="text/javascript"
      src="content/js/jquery-3.4.1.min.js"
    ></script>
    <!-- Bootstrap tooltips -->
    <script type="text/javascript" src="content/js/popper.min.js"></script>
    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="content/js/bootstrap.min.js"></script>
    <!-- MDB core JavaScript -->
    <script type="text/javascript" src="content/js/mdb.min.js"></script>
    <script>
      $(document).ready(function(params) {
        $("#passport").change(function(params) {
          var fileExtension = ["jpeg", "jpg", "png", "gif", "bmp"];

          if (
            $.inArray(
              $(this)
                .val()
                .split(".")
                .pop()
                .toLowerCase(),
              fileExtension
            ) == -1
          ) {
            this.files = null;
            $(this).val("");
            $("#passportErr").removeClass("d-none");
            $("#passportErr").html(
              "Only formats are allowed : " + fileExtension.join(", ") + "<br/>"
            );
          } else if (this.files[0].size > 2097152) {
            $("#passportErr").removeClass("d-none");
            $("#passportErr").html(
              $("#passportErr").text() +
                "" +
                "Try to upload file less than 2MB! (Your file size is" +
                this.files[0].size +
                "Byte)!"
            );
            this.files = null;
            $(this).val("");
          } else {
            $("#passportErr").addClass("d-none");
          }
        });

        var name = ["#resume", "#cover_letter"];
        name.forEach(element => {
          checkFile(element);
        });
        function checkFile(el) {
          $(el).change(function(params) {
            var Err = el + "Err";
            var fileExtension = ["pdf", "doc", "docx"];
            if (
              $.inArray(
                $(this)
                  .val()
                  .split(".")
                  .pop()
                  .toLowerCase(),
                fileExtension
              ) == -1
            ) {
              this.files = null;
              $(el).val("");

              $(Err).removeClass("d-none");
              $(Err).html(
                $(Err).text() +
                  "<br/>" +
                  "Only formats are allowed : " +
                  fileExtension.join(", ")
              );
            } else if (this.files[0].size > 2097152) {
              $(Err).removeClass("d-none");
              $(Err).html(
                $(Err).text() +
                  "" +
                  "Try to upload file less than 2MB! (Your file size is" +
                  this.files[0].size +
                  "Byte)!"
              );
              this.files = null;
              $(this).val("");
            } else {
              $(Err).addClass("d-none");
            }
          });
        }

        var emailRegex = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}$/;
        var nameRegex = /^[A-Z]+$/i; //new RegExp("/^[A-z]{3,30}$/i");
        var mobileRegex = /[0-9-()+]{3,20}/;

        function xxxxx(el, regExp, message) {
          console.log($(el).val());
          $(el).change(function(params) {
            //match email address
            //console.log(regExp.test($(this).val()));
            var err = el + "Err";
            if (regExp.test($(this).val())) {
              $(err).addClass("d-none");
            } else {
              $(err).removeClass("d-none");
              $(err).text(message);
              $(this).val("");
            }
          });
        }
        xxxxx("#first_name", nameRegex, "First Name is invalid");
        xxxxx("#last_name", nameRegex, "Last Name is invalid");
        xxxxx("#phone_no", mobileRegex, "Number is invalid");
        xxxxx("#country", nameRegex, "Country is invalid");
        xxxxx("#city", nameRegex, "City is invalid");
        xxxxx("#country", nameRegex, "Country is invalid");
        xxxxx("#state", nameRegex, "State is invalid");
      });
    </script>
  </body>
</html>
